<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>로또 게임</title>
    <link rel="stylesheet" href="styles.css">
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f4;
            margin: 0;
            padding: 20px;
        }
        .container {
            max-width: 600px;
            margin: auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        h1 {
            text-align: center;
            color: #333;
        }
        label {
            display: block;
            margin: 15px 0 5px;
        }
        input {
            width: 100%;
            padding: 10px;
            margin-bottom: 15px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        button {
            background-color: #28a745;
            color: white;
            padding: 10px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            width: 100%;
        }
        button:hover {
            background-color: #218838;
        }
        #result-section {
            display: none;
            margin-top: 20px;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            background: #e9ecef;
        }
        .fun-message {
            color: #ff6347; /* 토마토 색상 */
            font-weight: bold;
            font-size: 1.2em;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>로또 게임</h1>
        <div id="form-section">
            <label for="purchaseAmount">💰 로또 구매 금액을 입력해 주세요:</label>
            <input type="number" id="purchaseAmount" placeholder="구매 금액" required>
            <button id="next-btn">다음</button>
        </div>

        <div id="winning-number-section" style="display:none;">
            <label for="winningNumbers">당첨 번호를 입력해 주세요 (쉼표로 구분):</label>
            <input type="text" id="winningNumbers" placeholder="예: 1,2,3,4,5,6" required>
            
            <label for="bonusNumber">보너스 번호를 입력해 주세요:</label>
            <input type="number" id="bonusNumber" placeholder="보너스 번호" required>
            
            <button id="calculate-btn">결과 확인</button>
        </div>

        <div id="result-section">
            <h2>로또 결과</h2>
            <pre id="results"></pre>
            <div id="fun-message" class="fun-message"></div>
        </div>
    </div>

    <script>
        const purchaseAmountInput = document.getElementById('purchaseAmount');
        const winningNumbersInput = document.getElementById('winningNumbers');
        const bonusNumberInput = document.getElementById('bonusNumber');
        const nextButton = document.getElementById('next-btn');
        const calculateButton = document.getElementById('calculate-btn');
        const winningNumberSection = document.getElementById('winning-number-section');
        const resultSection = document.getElementById('result-section');
        const resultsDisplay = document.getElementById('results');
        const funMessageDisplay = document.getElementById('fun-message');

        // 다음 버튼 클릭 이벤트
        nextButton.addEventListener('click', goToWinningNumberSection);
        purchaseAmountInput.addEventListener('keypress', function (e) {
            if (e.key === 'Enter') goToWinningNumberSection();
        });

        function goToWinningNumberSection() {
            const purchaseAmount = purchaseAmountInput.value;
            if (!purchaseAmount || purchaseAmount <= 0) {
                alert('💸 올바른 구매 금액을 입력해주세요!');
                return;
            }
            winningNumberSection.style.display = 'block'; // 다음 섹션 표시
            purchaseAmountInput.disabled = true; // 입력 필드 비활성화
            nextButton.style.display = 'none'; // 다음 버튼 숨기기
            winningNumbersInput.focus(); // 다음 입력 필드로 포커스 이동
        }

        // 결과 확인 버튼 클릭 이벤트
        calculateButton.addEventListener('click', calculateResults);
        winningNumbersInput.addEventListener('keypress', function (e) {
            if (e.key === 'Enter') calculateResults();
        });
        bonusNumberInput.addEventListener('keypress', function (e) {
            if (e.key === 'Enter') calculateResults();
        });

        function calculateResults() {
            const purchaseAmount = purchaseAmountInput.value;
            const winningNumbers = winningNumbersInput.value.split(',').map(num => parseInt(num.trim()));
            const bonusNumber = parseInt(bonusNumberInput.value);

            // 로또 구매 금액과 당첨 번호 전송
            fetch('/api/lotto', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({ purchaseAmount, winningNumbers, bonusNumber }),
            })
            .then(response => {
                if (!response.ok) throw new Error('네트워크 오류');
                return response.json();
            })
            .then(data => {
                resultsDisplay.textContent = JSON.stringify(data.results, null, 2);
                resultSection.style.display = 'block';
                generateFunMessage(data.results); // 재미있는 메시지 생성
                purchaseAmountInput.value = ''; // 입력 필드 초기화
                winningNumbersInput.value = ''; // 입력 필드 초기화
                bonusNumberInput.value = ''; // 입력 필드 초기화
            })
            .catch(error => {
                console.error('Error:', error);
                alert('오류가 발생했습니다: ' + error.message);
            });
        }

        function generateFunMessage(results) {
            const messageArray = [
                "🎉 축하합니다! 당신은 로또 당첨의 주인공이 될 수 있습니다!",
                "💰 오늘의 운세가 좋네요! 당신의 로또 번호는 빛을 발할 것입니다!",
                "😅 아쉽지만, 다음 기회에 다시 도전해보세요!",
                "🚀 당신의 번호가 우주로 나아갑니다! 대박을 기대해보세요!",
                "🤞 행운을 빕니다! 당신의 번호가 행운의 별로 바뀔지도 몰라요!",
            ];

            // 랜덤 메시지 선택
            const randomMessage = messageArray[Math.floor(Math.random() * messageArray.length)];
            funMessageDisplay.textContent = randomMessage;
        }
    </script>
</body>
</html>
